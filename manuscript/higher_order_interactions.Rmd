---
bibliography: higher_order_interactions.bib
csl: ecology.csl
fontsize: 12pt
geometry: margin=1in
header-includes:
- \usepackage{lineno}
- \usepackage{setspace}
- \doublespacing
- \usepackage{amsmath}
- \usepackage{caption}
- \usepackage{bm}
- \newcommand{\beginsupplement}{\setcounter{table}{0}\renewcommand{\thetable}{S\arabic{table}}\setcounter{figure}{0}\renewcommand{\thefigure}{S\arabic{figure}}\setcounter{equation}{0}\renewcommand{\theequation}{S\arabic{equation}}}

layout: 12pt
linkcolor: black
output:
  pdf_document:
    fig_caption: yes
    keep_tex: yes
  word_document: default
urlcolor: black
---

```{r caching, include=FALSE}
library('png')
library('grid')
library("methods")
library("knitr")
basename <- "manuscript"
opts_chunk$set(fig.path = paste("components/figure/", basename, "-", sep=""),
               cache.path = paste("components/cache/", basename, "/", sep=""))
opts_chunk$set(cache = FALSE)
opts_chunk$set(tidy=FALSE, warning=FALSE, message=FALSE, 
               comment = NA, verbose = TRUE, echo=FALSE)

# PDF-based figures
opts_chunk$set(dev='pdf')
```

```{R echo = FALSE}

```


\renewcommand*{\thefootnote}{\fnsymbol{footnote}}

\begin{titlepage}
\begin{centering}

\sloppy

\ 

\ 

\ 

 


\textbf{\large{Where do higher order interactions come from?}}

\textsc{\small{Andrew R. Kleinhesselink\footnote{Corresponding author: arklein@ucla.edu}\textsuperscript{1}, Nathan Kraft\textsuperscript{1}, Jonathan M. Levine\textsuperscript{2}}}


\textit{\small{\textsuperscript{1}Department of Ecology and Evolutionary Biology, University of California, Los Angeles 621 Charles E. Young Drive South Los Angeles, CA 90095 USA}} \\
\textit{\small{\textsuperscript{2}ETH, Zurich Switzerland}} \\

\end{centering}

\bigskip \textbf{Running title:} Higher order interactions

\smallskip \textbf{Submission type:} Article
\vspace{3 cm}



\renewcommand*{\thefootnote}{\arabic{footnote}}
\setcounter{footnote}{0}

\end{titlepage}
\pagebreak{}
\linenumbers

Abstract
--------

In most classical models of species competition, the outcome of competition is determined by fixed pairwise competition coefficients.  

However, almost every community on earth contains many more than two species, and almost every species interacts with more than one other competitor. 

Therefore, it cannot be assumed that models based upon pairwise per capita competition adequately describe multi-species communities.   

Specifically, higher order interactions (HOI) invalidate the use of pairwise competition coefficients for any community with three or more species. 

HOIs occur when pairwise competition coefficients are not fixed and instead depend on the density of other species in the community. 

The question of when and where HOIs occur is thus critical to extending the insights derived from two species models to natural communities.

In this paper we examine whether HOIs emerge in simple mechanistic models with more than two species and attempt to classify their origin. 





*Key words: competition, coexistence theory*

Introduction
-------------

Almost every species on earth interacts with a vast number of predators, pathogens and competitors. And the densities of each of these species, are themselves determined by interactions with yet other species in the community. Nonetheless, most classical models in community ecology summarise species interactions with fixed pairwise interaction coeficients. In particular, pairwise competition coefficients have been critical to the development of modern coexistence theory (MCT). A powerful implication arising from the assumption of fixed pairwise competition coefficients is that the outcome of multi-species species competition can be predicted by measuring the outcome of competition between all pairs of species in that community (cite). This assumptions leads to the idea that a general theory of species competitive exclusion and coexistence can be achieved if one could simply map pairwise differences in species' traits and physiology to species pairwise competition coefficients [@kraft_plant_2015; @adler_trait-based_2013]. 

The possibility of higher order interactions (HOIs) between species challenges the core assumption of pairwise competition coefficients.  By definition, HOIs mean that pairwise competition coefficients are not themselves fixed, but depend upon the densities of other species in the community. If HOIs are common, then predicting community assembly in natural multi-species communities cannot be achieved by measuring all possible pairwise competitive interactions. Thus, a thorough empirical and theoretical investigation of HOI in natural communities is absolutely critical to expanding ecological beyond two species models to the natural world.  


#### Defining higher order interactions 

Despite the importance of HOIs for advancing ecology in a multi-species world, competitive HOIs have received relatively little theoretical or empirical attention. This extends even to the matter of defining what they are.  

To even begin discussing HOIs, we need to first define competition.  We approach the definition from a phenomenological perspective and define competition as the observed reduction in per-capita population growth rate due to an increase in density of individuals of the same trophic level (cite).  

In figure (1) competition is depicted as arrows showing that density of individual $j$ reduces the per capita population growth rate of species $i$ by some factor $f_i(n_j)$. In figure 1 the dashed arrow shows that species 3 modifies the competitive effect of species two on species one.  We take this kind of interaction modification to be a higher order interaction.  More specifically, an HOI occurs whenever the competitive effect of species $j$ on $i$ depends on the density of another species $k$.    

A more technical definition of HOIs proceeds from the the following general phenomenological model for competition, 

\vspace{-4em}
\begin{equation} \label{eq1}
\begin{split}
n_{i,t+1} = n_{i,t}\lambda_{i}/f_{i}(\bf{n_{t}}), 
\end{split}
\end{equation}

where $n_{i,t}$ is the density of species $i$ at time $t$, $\lambda_{i}$ gives the per capita population growth rate in the absence of competition, the function $f_i$ gives the factor by which competition reduces population growth rate, and $\bf{n_t}$ is a vector giving the density of each of $n$ species in the community. The net outcome of all competition is given by the function $f_i$ and therefore depends on the density of all species in the community. Nevertheless, competition is still pairwise and does not involve HOIs if the sensitivity of the function $f$ to the density of another competitor species $j$, given by the partial derivative $\frac{\partial f_{i}}{\partial n_{j}}$, does not depend on the density of any other species.  

In contrast, HOIs occur whenever the partial derivative $\frac{\partial f_{i}}{\partial n_{j}}$ depends also on the density of at least one other competitor species. 

To illustrate our definition, consider defining the competition function $f$ as a simple linear function of competitor density: $f_i(\bf{n_t}) = (1 + \sum \alpha_{i,j}n_{j,t})$ (cite Hassell). Where $\alpha_{i,j}$ gives the pairwise competitive effect of species $j$ on the species $i$ The overall discrete time dynamics for species $i$ are now given by the equation, 
\vspace{-4em}
\begin{equation} \label{eq2}
\begin{split}
n_{i,t+1} = n_{i,t}\frac{\lambda_i}{(1 + \sum_{j=1}^{n}\alpha_{i,j}n_{j,t})}, 
\end{split}
\end{equation}

In the above model, the sensitivity of competition to the density of competitor $j$ is given by the partial derivative $\frac{\partial f_i}{\partial n_{j}} = \alpha_{i,j}$.  

If we relax the assumption that pairwise competition coefficients are fixed and instead allow each to themselves be functions competitor densities, our model now includes the possibility of HOIs.  

As an example, consider a three species community.  We replace $\alpha_{1,2}$ with a simple linear function of $n_3$, $a(n_3) = \alpha_{1,2} + \beta n_3$. Now the competitive effect of $n_{2}$ on $n_{1}$ depends on the density of a third species, 

\vspace{-4em}
\begin{equation} \label{eq3}
\begin{split}
f_{1,t+1} = (1 + \alpha_{1,1}n_{1,t} + \alpha_{1,2}n_{2,t} + \beta n_{3,t}n_{2,t} + \alpha_{1,3}n_{3,t}),
\end{split}
\end{equation}

where $\beta$ captures a second order HOI effect of species two and three together. As long as $\beta \neq 0$ we can no longer isolate the pairwise sensitivity of species 2 and must consider also the density of species 3 when defining the partial derivative $\frac{\partial f_i}{\partial n_2}$. The same goes for species 3.  In general, a community of more species could include HOIs of greater order, with a community of $n$ species having HOIs up to the $n-1th$ order possible. 

Now that we have defined HOIs we ask whether there are any reason to suspect competitive HOIs exist in nature.

#### HOIs arrising from sequences of pairwise competition

Grilli et al. (2017) recently demonstrated how HOIs can arise from a sequence of competitive events defined only by pairwise competition.  In their model, seedling trees compete to fill a forest gap.  If competition for the gap occurs as a sequence of competitive rounds between pairs of individuals, then the overall chance of a species winning the gap depends on the presence of all other species in the gap and their interactions. That is, the species' chance of winning each round is pairwise, but the species chance of winning the overall tournament depends on higher order interactions.

In the Grilli paper, competition was a set discrete winner-take-all competitive events. The specific idea of having plant competition occur one at a time in the form of tournaments seems unrealistic, however, their model captures an important general way in which competition that is pairwise at a short timescale can produce HOIs when aggregated across longer time periods. As a simple illustration of this idea, consider a two stage population model with juveniles and adults. The probability of transitioning from juvenile to adult is determined by a survival function $s$ and the fecundity of adults is given by $g$.  It seems likely that both $s$ and $g$ could be influenced by pairwise competition. 

We can model population growth as 

\vspace{-4em}
\begin{equation} \label{eq3}
\begin{split}
N_{1,t+1} = N_{1,t}r(1 - \alpha_{1,1}N_{1,t} - \alpha_{1,2}N_{2,t} + \beta N_{3,t}N_{2,t} - \alpha_{1,3}N_{3,t}),
\end{split}
\end{equation}





Methods
---------------------
#### Phenomenological models of annual plant competition  

Annual plant demography and competition can be modeled using a system of difference equations relating annual plant density in year 

\vspace{-4em}
\begin{equation} \label{eq1}
\begin{split}
N_{i,t+1} = N_{i,t}\lambda_i (1 + \sum_{j = 1}^n \alpha_{ij}N_{j,t})^{\tau_i}, 
\end{split}
\end{equation}

where $\tau_{i} < 0$. 


\vspace{-4em}
\begin{equation} \label{eq2}
\begin{split}
N_{i,t+1} = N_{i,t}\frac{ \lambda_i }{ (1 + \sum_{j = 1}^nN_{j,t}^{\eta_j}) }, 
\end{split}
\end{equation}

where $\eta_{j} > 0$.

#### Resource mechanistic model

\vspace{-4em}
\begin{equation} \label{eq3}
\begin{split}
\frac{dB_{i}}{du} = B_{i}(qf(R, r, K) - m)
\end{split}
\end{equation}


\vspace{-4em}
\begin{equation} \label{eq4}
\begin{split}
\frac{dR}{du} = p[u] - \epsilon R - \sum_{i = 1}^nB_{i}f(R,r, K)
\end{split}
\end{equation}


\vspace{-4em}
\begin{equation} \label{eq5}
\begin{split}
f(R, r, K) = rR/(K + R)
\end{split}
\end{equation}

In this model, the growth of each species stops at day $z$ when $dB_i/du = 0$.  We simulate the senescence of the plant and the cesation of resource uptake by setting $B_i(z) = 0$. 

To find total seeds produced per species $S_i$, we multiply each species maximum biomass $\max(B_i)$ by a reproductive allocation factor $c$ and divide by mass per seed to $\nu$: $S_i = c\max(B_i)/\nu$.


#### Assessing higher order interactions


Results
-------

Discussion
-----------

Conclusion
----------


Acknowledgments
---------------

\pagebreak{}

References
----------
\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{12pt}
\noindent


<div id="refs"></div>


\pagebreak{} 

\setlength{\parindent}{0in}
\setlength{\leftskip}{0in}
\setlength{\parskip}{12pt}

Tables
------

<!-- \captionsetup{width=14cm} -->
<!-- \begin{table}[ht] -->
<!-- \centering -->
<!-- \caption{Summary of } -->
<!-- \label{tab:table1} -->
<!-- \begin{tabular}{llll} -->
<!--   \toprule -->
<!--   \input{ test.txt} -->
<!-- \end{tabular} -->
<!-- \end{table} -->


\pagebreak{}


Figure Legends
-------

**Figure \ref{fig:hypothesis}.** 

**Figure \ref{fig:map}.** 

**Figure \ref{fig:effects}.** 

\pagebreak{}


Figures
------

<!-- \begin{figure}[!ht] -->
<!--   \centering -->
<!--       \includegraphics[width=6in]{../figures/hypothesis.png} -->
<!--   \caption{} -->
<!--   \label{fig:hypothesis} -->
<!-- \end{figure} -->


\pagebreak{}


Appendix S1:
===========================================================================

\beginsupplement


```{R echo = FALSE}

```


Mechanistic Model
------


\pagebreak{}


Tables
------

<!-- \captionsetup{width=14cm} -->
<!-- \begin{table}[ht] -->
<!-- \centering -->
<!-- \caption{} -->
<!-- \label{tab:subspecies} -->
<!-- \begin{tabular}{llll} -->
<!--   \toprule -->
<!--   \input{ ../data/table.txt} -->
<!-- \end{tabular} -->
<!-- \end{table} -->



\pagebreak{}



Figures
-------



<!-- \begin{figure}[!ht] -->
<!--   \centering -->
<!--       \includegraphics[width=6in]{../figures/test.png} -->
<!--   \caption{} -->
<!--   \label{fig:test} -->
<!-- \end{figure} -->


