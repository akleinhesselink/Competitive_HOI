---
bibliography: higher_order_interactions.bib
csl: ecology.csl
fontsize: 12pt
geometry: margin=1in
header-includes:
- \usepackage{lineno}
- \usepackage{setspace}
- \doublespacing
- \usepackage{amsmath}
- \usepackage{caption}
- \usepackage{bm}
- \newcommand{\beginsupplement}{\setcounter{table}{0}\renewcommand{\thetable}{S\arabic{table}}\setcounter{figure}{0}\renewcommand{\thefigure}{S\arabic{figure}}\setcounter{equation}{0}\renewcommand{\theequation}{S\arabic{equation}}}

layout: 12pt
linkcolor: black
output:
  pdf_document:
    fig_caption: yes
    keep_tex: yes
  word_document: default
urlcolor: black
---

```{r caching, include=FALSE}
library('png')
library('grid')
library("methods")
library("knitr")
basename <- "manuscript"
opts_chunk$set(fig.path = paste("components/figure/", basename, "-", sep=""),
               cache.path = paste("components/cache/", basename, "/", sep=""))
opts_chunk$set(cache = FALSE)
opts_chunk$set(tidy=FALSE, warning=FALSE, message=FALSE, 
               comment = NA, verbose = TRUE, echo=FALSE)

# PDF-based figures
opts_chunk$set(dev='pdf')
```

```{R echo = FALSE}

```


\renewcommand*{\thefootnote}{\fnsymbol{footnote}}

\begin{titlepage}
\begin{centering}

\sloppy

\ 

\ 

\ 

 


\textbf{\large{Where do higher order interactions come from?}}

\textsc{\small{Andrew R. Kleinhesselink\footnote{Corresponding author: arklein@ucla.edu}\textsuperscript{1}, Nathan Kraft\textsuperscript{1}, Jonathan M. Levine\textsuperscript{2}}}


\textit{\small{\textsuperscript{1}Department of Ecology and Evolutionary Biology, University of California, Los Angeles 621 Charles E. Young Drive South Los Angeles, CA 90095 USA}} \\
\textit{\small{\textsuperscript{2}ETH, Zurich Switzerland}} \\

\end{centering}

\bigskip \textbf{Running title:} Higher order interactions

\smallskip \textbf{Submission type:} Article
\vspace{3 cm}



\renewcommand*{\thefootnote}{\arabic{footnote}}
\setcounter{footnote}{0}

\end{titlepage}
\pagebreak{}
\linenumbers

Abstract
--------

In most classical models of species competition, the outcome of competition is determined by fixed pairwise competition coefficients.  

However, almost every community on earth contains many more than two species, and almost every species interacts with more than one other competitor. 

Therefore, it cannot be assumed that models based upon pairwise per capita competition adequately describe multi-species communities.   

Specifically, higher order interactions (HOI) invalidate the use of pairwise competition coefficients for any community with three or more species. 

HOIs occur when pairwise competition coefficients are not fixed and instead depend on the density of other species in the community. 

The question of when and where HOIs occur is thus critical to extending the insights derived from two species models to natural communities.

In this paper we examine whether HOIs emerge in simple mechanistic models with more than two species and attempt to classify their origin. 





*Key words: competition, coexistence theory*

Introduction
-------------

Almost every species on earth interacts with a vast number of predators, pathogens and competitors. And the densities of each of these species, are themselves determined by interactions with yet other species in the community. Nonetheless, most classical models in community ecology summarise species interactions with fixed pairwise interaction coeficients. In particular, pairwise competition coefficients have been critical to the development of modern coexistence theory (MCT). A powerful implication arising from the assumption of fixed pairwise competition coefficients is that the outcome of multi-species species competition can be predicted by measuring the outcome of competition between all pairs of species in that community (cite). This assumptions leads to the idea that a general theory of species competitive exclusion and coexistence can be achieved if one could simply map pairwise differences in species' traits and physiology to species pairwise competition coefficients [@kraft_plant_2015; @adler_trait-based_2013]. 

The possibility of higher order interactions (HOIs) between species challenges the core assumption of pairwise competition coefficients.  By definition, HOIs mean that pairwise competition coefficients are not themselves fixed, but depend upon the densities of other species in the community. If HOIs are common, then predicting community assembly in natural multi-species communities cannot be achieved by measuring all possible pairwise competitive interactions. Thus, a thorough empirical and theoretical investigation of HOI in natural communities is absolutely critical to expanding ecological beyond two species models to the natural world.  


#### Defining higher order interactions 

Despite the importance of HOIs for advancing ecology in a multi-species world, competitive HOIs have received relatively little theoretical or empirical attention. This extends even to the matter of defining what they are.  

To even begin discussing HOIs, we need to first define competition.  We approach the definition from a phenomenological perspective and define competition as the observed reduction in a per-capita population growth rate due to an increase in density of individuals of the same trophic level (cite).  

In figure (1) competition is depicted as arrows showing that density of species $j$ reduces the vital rate of species $i$ by some factor $C_{ij}$. In figure 1 the dashed arrow shows that species $k$ modifies the competitive effect of species $j$ on species $i$.  We take this kind of interaction modification to be a second order competitive interaction, an HOI.  More specifically, an HOI occurs whenever the competitive effect of species $j$ on $i$ depends on the density of another species.    
A more technical example of HOIs follows from the following phenomenological population growth rate model, 

\vspace{-4em}
\begin{equation} \label{eq1}
\begin{split}
n_{i,t+1} = n_{i,t}f(C(n_i, n_j, n_k)), 
\end{split}
\end{equation}

where $n_{i,t}$ is the density of species $i$ at time $t$, $f$ is a function that gives the per capita population growth rate as a function of competition experienced $C$, which itself is a function of a competitor densities, $n_i$, $n_j$, and $n_k$. Competition between species $i$ and $j$ is pairwise and does not involve HOIs if the sensitivity of competition, defined as the partial derivative $\frac{\partial C_{i}}{\partial n_{j}}$, does not vary with the density of any other species in the community ($n_k$). In contrast, HOIs occur whenever the sensitivity of competition to the density of a single competitor species changes with the density of one or more other competitor species. 

As a specific example, consider defining the competition as a simple linear function of competitor density: $C(n_i,n_j,n_k) = (1 + \alpha_{i,i}n_{i} + \alpha_{i,j}n_{j} + \alpha_{i,k}n_k)$ (cite Hassell). Where $\alpha_{i,j}$ gives the pairwise competitive effect of species $j$ on the species $i$ and the sensitivity of competition to the density of competitor $j$ is given by the partial derivative $\frac{\partial C}{\partial n_{j}} = \alpha_{i,j}$.  

If we relax the assumption that pairwise competition coefficients are fixed and instead allow the competition coefficients to depend on other competitor densities, our model now includes the possibility of HOIs.  As an example, we replace $\alpha_{i,j}$ with a simple linear function of $n_k$, $a(n_k) = \alpha_{i,j} + \beta n_k$. Now the competitive effect of $n_{j}$ on $n_{i}$ depends on the density of a third species $n_k$:  

\vspace{-4em}
\begin{equation} \label{eq3}
\begin{split}
C(\bf{N}) = (1 + \alpha_{i,i}n_{i} + \alpha_{i,j}n_{j} + \beta n_{k}n_{j} + \alpha_{i,k}n_{k}). 
\end{split}
\end{equation}

In this example, $\beta$ captures a second order HOI effect of species $j$ and $k$ together. As long as $\beta \neq 0$ we can no longer isolate the pairwise effect of species $j$ on species $i$. In general, more diverse communities could contain HOIs of greater order, with a community of $s$ species having HOIs possible up the $s-1th$ order. 

Now that we have defined HOIs we ask whether there are any reason to suspect competitive HOIs actually exist in nature.

#### HOIs arrising from sequences of pairwise competition

Higher order interactions could arise in discrete time models when the time step involves aggregating of a sequence of pairwise competition events. In a recent theoretical analysis, Grilli et al. (2017) provided a concise demonstration of this effect.  In their model, seedling trees compete to fill a forest gap.  If competition for the gap occurs as a sequence of competitive rounds between pairs of individuals, then the overall chance of a species winning the gap depends on the presence of all other species in the gap.  Importantly, the probability that a species wins the gap depends not only on its pairwise interactions with its competitors, but also on the pairwise interactions between those competitors. In effect, a species' chance of winning each round is pairwise, but the species' chance of winning the overall tournament includes higher order interactions.

In the Grilli model, competition involved a tournament of discrete winner-take-all competitive events. The idea of having plant competition occur one at a time in this way seems unrealistic. However, their model captures an important general way in which competition that is pairwise at a single time step can produce HOIs when aggregated over more then one time step. As another example we consider a two stage annual plant population model with seedlings $\bf{S}$ and adults $\bf{A}$ (fig 2). The probability of transitioning from seedling to adult in calendar year $t$ is determined by a survival function $p$. The production of seeds by adults is given by a reproduction function $g$. Because the plants are annuals there is no adult survival, and to simplify things we assume that all seeds germinate. Starting from the seedling stage, per capita population growth rate, $f$, is determined by the product of seedling survival and adult per capita seed production, $f = s_{i,t+1}/s_{i,t} = gp$. In our model, both $p$ and $g$ could be reduced by competition from seedlings and adults respectively such that $p(\bf{S_t})$ and $g(\bf{A_t})$, where $S_t$ gives vector of seedling densities, and $A_t$ is a vector of adult densities. 

If we calculated the sensitivity of population growth rate to seedling density, it would include a component coming from the effect of seedlings on survival and a component coming from the effect of adults on reproduction. For example, in a two species community the sensitivity of $f$ to seedling density of species $j$ would be,  
\vspace{-4em}
\begin{equation} \label{eq3}
\begin{split}
\frac{\partial{f}}{\partial{s_{j}}} = \frac{\partial{p}}{\partial{s_{j}}}g(p(s_{j}))
\end{split}
\end{equation}





Methods
---------------------
#### Phenomenological models of annual plant competition  

Annual plant demography and competition can be modeled using a system of difference equations relating annual plant density in year 

\vspace{-4em}
\begin{equation} \label{eq1}
\begin{split}
N_{i,t+1} = N_{i,t}\lambda_i (1 + \sum_{j = 1}^n \alpha_{ij}N_{j,t})^{\tau_i}, 
\end{split}
\end{equation}

where $\tau_{i} < 0$. 


\vspace{-4em}
\begin{equation} \label{eq2}
\begin{split}
N_{i,t+1} = N_{i,t}\frac{ \lambda_i }{ (1 + \sum_{j = 1}^nN_{j,t}^{\eta_j}) }, 
\end{split}
\end{equation}

where $\eta_{j} > 0$.

#### Resource mechanistic model

\vspace{-4em}
\begin{equation} \label{eq3}
\begin{split}
\frac{dB_{i}}{du} = B_{i}(qf(R, r, K) - m)
\end{split}
\end{equation}


\vspace{-4em}
\begin{equation} \label{eq4}
\begin{split}
\frac{dR}{du} = p[u] - \epsilon R - \sum_{i = 1}^nB_{i}f(R,r, K)
\end{split}
\end{equation}


\vspace{-4em}
\begin{equation} \label{eq5}
\begin{split}
f(R, r, K) = rR/(K + R)
\end{split}
\end{equation}

In this model, the growth of each species stops at day $z$ when $dB_i/du = 0$.  We simulate the senescence of the plant and the cesation of resource uptake by setting $B_i(z) = 0$. 

To find total seeds produced per species $S_i$, we multiply each species maximum biomass $\max(B_i)$ by a reproductive allocation factor $c$ and divide by mass per seed to $\nu$: $S_i = c\max(B_i)/\nu$.


#### Assessing higher order interactions


Results
-------

Discussion
-----------

Conclusion
----------


Acknowledgments
---------------

\pagebreak{}

References
----------
\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{12pt}
\noindent


<div id="refs"></div>


\pagebreak{} 

\setlength{\parindent}{0in}
\setlength{\leftskip}{0in}
\setlength{\parskip}{12pt}

Tables
------

<!-- \captionsetup{width=14cm} -->
<!-- \begin{table}[ht] -->
<!-- \centering -->
<!-- \caption{Summary of } -->
<!-- \label{tab:table1} -->
<!-- \begin{tabular}{llll} -->
<!--   \toprule -->
<!--   \input{ test.txt} -->
<!-- \end{tabular} -->
<!-- \end{table} -->


\pagebreak{}


Figure Legends
-------

**Figure \ref{fig:hypothesis}.** 

**Figure \ref{fig:map}.** 

**Figure \ref{fig:effects}.** 

\pagebreak{}


Figures
------

<!-- \begin{figure}[!ht] -->
<!--   \centering -->
<!--       \includegraphics[width=6in]{../figures/hypothesis.png} -->
<!--   \caption{} -->
<!--   \label{fig:hypothesis} -->
<!-- \end{figure} -->


\pagebreak{}


Appendix S1:
===========================================================================

\beginsupplement


```{R echo = FALSE}

```


Mechanistic Model
------


\pagebreak{}


Tables
------

<!-- \captionsetup{width=14cm} -->
<!-- \begin{table}[ht] -->
<!-- \centering -->
<!-- \caption{} -->
<!-- \label{tab:subspecies} -->
<!-- \begin{tabular}{llll} -->
<!--   \toprule -->
<!--   \input{ ../data/table.txt} -->
<!-- \end{tabular} -->
<!-- \end{table} -->



\pagebreak{}



Figures
-------



<!-- \begin{figure}[!ht] -->
<!--   \centering -->
<!--       \includegraphics[width=6in]{../figures/test.png} -->
<!--   \caption{} -->
<!--   \label{fig:test} -->
<!-- \end{figure} -->


